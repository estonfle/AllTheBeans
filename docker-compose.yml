services:
  # 1. The .NET API
  backend:
    build:
      context: ./AllTheBeans-Backend
      dockerfile: Dockerfile
    ports:
      - "5089:8080" # Maps localhost:5089 to container:8080
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      # Override the DB path to point to the volume
      - ConnectionStrings__DefaultConnection=Data Source=/app/data/AllTheBeans.db
    volumes:
      # Persist the database file on your host machine
      - ./db_data:/app/data

  # 2. The React UI (Nginx)
  frontend:
    build:
      context: ./AllTheBeans-Frontend
      dockerfile: Dockerfile
    ports:
      - "3000:80" # Maps localhost:3000 to container:80
    depends_on:
      - backend